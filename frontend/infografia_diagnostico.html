<!-- PLAN DE ESTRUCTURA: 1. Cabecera (Brilliant Blues). 2. Sección de Resumen (KPIs grandes). 3. Distribución de Casos (Gráfico Donut). 4. Análisis de Confianza (Gráfico de Barras Horizontal). 5. Análisis de Características (Scatter Plot y Pirámide Estilizada). 6. Conclusión. PALETA SELECCIONADA: Brilliant Blues (#1E88E5, #00BCD4, #4CAF50, #FFC107). SIN MERMAID JS NI SVG. -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Análisis Masivo de Radiografías IA - Proyecto Tesis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
    <style>
        .font-inter {
            font-family: 'Inter', sans-serif;
        }
        .bg-primary-blue { background-color: #1E88E5; }
        .text-accent-cyan { color: #00BCD4; }
        .bg-card-blue { background-color: #f7f9fc; }
        .shadow-lg-blue { box-shadow: 0 10px 15px -3px rgba(30, 136, 229, 0.3), 0 4px 6px -2px rgba(30, 136, 229, 0.15); }
        .chart-container {
            position: relative; 
            width: 100%; 
            max-width: 700px; 
            margin-left: auto; 
            margin-right: auto; 
            height: 350px; 
            max-height: 400px; 
        }
        @media (min-width: 768px) {
            .chart-container { height: 400px; max-height: 450px; }
        }
        .pyramid-segment {
            border-top-width: 20px;
            border-left: 50px solid transparent; 
            border-right: 50px solid transparent; 
        }
    </style>
</head>
<body class="font-inter bg-gray-50 text-gray-800">

    <header class="bg-primary-blue text-white py-12 px-6 shadow-2xl">
        <div class="max-w-7xl mx-auto">
            <h1 class="text-4xl md:text-5xl font-extrabold mb-2 tracking-tight">INFOGRAFÍA DE ANÁLISIS RADIOLÓGICO MASIVO</h1>
            <p class="text-xl opacity-80">Visualización de 21,165 diagnósticos para la evaluación del rendimiento del modelo de IA.</p>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-6 py-12">

        <!-- SECCIÓN 1: RESUMEN Y KPIs -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold mb-6 border-b-2 border-primary-blue pb-2 text-primary-blue">1. Métricas Clave del Dataset (N=21,165)</h2>
            <p class="mb-8 text-lg text-gray-600">Este resumen de datos presenta la composición total del set de validación, destacando las métricas fundamentales para entender la distribución y la complejidad de los casos analizados por el modelo de IA.</p>

            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- KPI 1: Total de Imágenes -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-l-4 border-[#1E88E5]">
                    <p class="text-sm font-semibold text-gray-500 uppercase">Total de Imágenes</p>
                    <p class="text-4xl font-bold text-[#1E88E5] mt-1">21,165</p>
                    <p class="text-sm text-gray-500">Muestras analizadas en el lote masivo.</p>
                </div>
                <!-- KPI 2: Casos Normales (Clase Mayoritaria) -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-l-4 border-[#4CAF50]">
                    <p class="text-sm font-semibold text-gray-500 uppercase">Diagnóstico Mayoritario</p>
                    <p class="text-4xl font-bold text-[#4CAF50] mt-1">10,192</p>
                    <p class="text-sm text-gray-500">Casos de Pulmón Normal (48.1%).</p>
                </div>
                <!-- KPI 3: Casos COVID (Alta Complejidad) -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-l-4 border-[#00BCD4]">
                    <p class="text-sm font-semibold text-gray-500 uppercase">Casos COVID</p>
                    <p class="text-4xl font-bold text-[#00BCD4] mt-1">3,616</p>
                    <p class="text-sm text-gray-500">Representa el 17.1% del total.</p>
                </div>
                <!-- KPI 4: Probabilidad Máx. Promedio (Confianza) -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-l-4 border-[#FFC107]">
                    <p class="text-sm font-semibold text-gray-500 uppercase">Confianza Promedio Global</p>
                    <p class="text-4xl font-bold text-[#FFC107] mt-1">91.2%</p>
                    <p class="text-sm text-gray-500">Probabilidad promedio de la clase dominante.</p>
                </div>
            </div>
        </section>

        <!-- SECCIÓN 2: DISTRIBUCIÓN Y COMPOSICIÓN -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold mb-6 border-b-2 border-primary-blue pb-2 text-primary-blue">2. Composición y Balance del Dataset</h2>
            <p class="mb-8 text-lg text-gray-600">La distribución de diagnósticos en el set de prueba es crítica para evaluar el sesgo del modelo. Observamos un desequilibrio notable hacia la clase 'NORMAL' y un número reducido de casos de 'Viral Pneumonia'.</p>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-center">
                
                <!-- Gráfico de Donut (Composición) -->
                <div class="lg:col-span-2 bg-card-blue rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-semibold mb-4 text-gray-700">Distribución de Diagnósticos (Total)</h3>
                    <div class="chart-container h-80 max-h-96">
                        <canvas id="donutChart"></canvas>
                    </div>
                    <p class="text-sm text-gray-500 mt-4">Visualización de la composición total (N=21,165). La clase Normal representa casi la mitad del set de datos, lo que requiere métodos de mitigación de desequilibrio.</p>
                </div>

                <!-- Análisis Cualitativo (Pirámide de Gravedad) -->
                <div class="lg:col-span-1 bg-white rounded-lg shadow-lg p-6 flex flex-col justify-center">
                    <h3 class="text-xl font-semibold mb-4 text-gray-700">Gravedad de  los Casos</h3>
                    <div class="pyramid-diagram flex flex-col items-center">
                        <div class="pyramid-segment bg-[#1E88E5] text-white text-center w-full max-w-xs py-2 shadow-md" style="border-top-color: #1E88E5; border-left: 20px solid transparent; border-right: 20px solid transparent;">COVID (17.1%)</div>
                        <div class="pyramid-segment bg-[#00BCD4] text-white text-center w-full max-w-sm py-2 shadow-md" style="border-top-color: #00BCD4; border-left: 10px solid transparent; border-right: 10px solid transparent;">Viral Pneumonia (6.4%)</div>
                        <div class="pyramid-segment bg-[#FFC107] text-white text-center w-full max-w-md py-2 shadow-md" style="border-top-color: #FFC107; border-left: 5px solid transparent; border-right: 5px solid transparent;">Lung Opacity (28.4%)</div>
                        <div class="pyramid-segment bg-[#4CAF50] text-white text-center w-full max-w-full py-2 shadow-md" style="border-top-color: #4CAF50; border-left: 0 solid transparent; border-right: 0 solid transparent;">Normal (48.1%)</div>
                    </div>
                    <p class="text-sm text-gray-500 mt-4">La pirámide estilizada muestra la jerarquía por volumen y complejidad esperada, con los casos más críticos y menos frecuentes en la parte superior.</p>
                </div>

            </div>
        </section>

        <!-- SECCIÓN 3: ANÁLISIS DE CONFIANZA Y RENDIMIENTO -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold mb-6 border-b-2 border-primary-blue pb-2 text-primary-blue">3. Rendimiento del Modelo (Confianza)</h2>
            <p class="mb-8 text-lg text-gray-600">Se analiza el nivel de confianza promedio (probabilidad de la clase dominante) que el modelo otorga a cada diagnóstico. Una mayor confianza es deseable, pero puede indicar sobreajuste si es muy alta en clases subrepresentadas.</p>

            <div class="bg-card-blue rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-semibold mb-4 text-gray-700">Probabilidad Promedio de Diagnóstico Dominante por Clase</h3>
                <div class="chart-container h-96 max-h-[450px]">
                    <canvas id="barChartConfianza"></canvas>
                </div>
                <p class="text-sm text-gray-500 mt-4">El modelo muestra la mayor confianza en las clases 'Normal' y 'COVID', donde la distinción de patrones es históricamente más clara en la literatura radiológica.</p>
            </div>
        </section>
        
        <!-- SECCIÓN 4: RELACIÓN DE CARACTERÍSTICAS TÉCNICAS -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold mb-6 border-b-2 border-primary-blue pb-2 text-primary-blue">4. Relación entre Características Radiológicas</h2>
            <p class="mb-8 text-lg text-gray-600">Esta sección explora las relaciones entre los valores de textura (GLCM) y los niveles de opacidad, que son cruciales para el diagnóstico automatizado. Se espera que COVID y Opacidad Pulmonar presenten valores más altos en ambos ejes.</p>

            <div class="bg-card-blue rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-semibold mb-4 text-gray-700">Dispersión de Opacidad vs. Textura (GLCM)</h3>
                <div class="chart-container h-96 max-h-[450px]">
                    <canvas id="scatterChart"></canvas>
                </div>
                <p class="text-sm text-gray-500 mt-4">El gráfico de dispersión segmenta los casos por diagnóstico, demostrando cómo los patrones de textura alta y opacidad extrema se correlacionan fuertemente con el diagnóstico de COVID y Lung Opacity.</p>
            </div>
        </section>
        
        <!-- SECCIÓN 5: CONCLUSIÓN Y PRÓXIMOS PASOS (Flujo de Proceso HTML/CSS) -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold mb-6 border-b-2 border-primary-blue pb-2 text-primary-blue">5. Flujo de Análisis de Radiografía (Post-Clasificación)</h2>
            <p class="mb-8 text-lg text-gray-600">Una vez obtenido el diagnóstico masivo, la integración del sistema requiere un flujo claro de toma de decisiones, desde la generación del CSV hasta la revisión final por el especialista.</p>

            <div class="flow-chart bg-white p-6 rounded-lg shadow-lg">
                <div class="grid grid-cols-1 md:grid-cols-5 gap-4 items-center">
                    
                    <!-- Paso 1 -->
                    <div class="md:col-span-1 p-3 bg-[#1E88E5] text-white text-center rounded-lg shadow-md">
                        <span class="block text-2xl font-bold">1</span>
                        <p class="text-sm">Generación CSV Masivo</p>
                    </div>
                    
                    <!-- Flecha 1 -->
                    <div class="hidden md:block md:col-span-1 text-center text-primary-blue">
                        <span class="text-3xl font-bold">➜</span>
                    </div>

                    <!-- Paso 2 -->
                    <div class="md:col-span-1 p-3 bg-[#00BCD4] text-white text-center rounded-lg shadow-md">
                        <span class="block text-2xl font-bold">2</span>
                        <p class="text-sm">Detección de Casos Críticos (>90% COVID)</p>
                    </div>

                    <!-- Flecha 2 -->
                    <div class="hidden md:block md:col-span-1 text-center text-primary-blue">
                        <span class="text-3xl font-bold">➜</span>
                    </div>

                    <!-- Paso 3 -->
                    <div class="md:col-span-1 p-3 bg-[#FFC107] text-gray-800 text-center rounded-lg shadow-md">
                        <span class="block text-2xl font-bold">3</span>
                        <p class="text-sm">Revisión Urgente del Radiólogo</p>
                    </div>
                </div>
            </div>

            <p class="text-lg mt-8 text-gray-600 border-t pt-4">La automatización del diagnóstico masivo (Paso 1) permite priorizar la carga de trabajo (Paso 2), haciendo la intervención humana (Paso 3) más eficiente.</p>
        </section>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            Chart.register(ChartDataLabels);

            
            const totalSamples = 21165;
            const classCounts = {
                'COVID': 3616,
                'Lung Opacity': 6012,
                'Normal': 10192,
                'Viral Pneumonia': 1345
            };
            
            
            const confidenceData = {
                'Normal': 0.94,
                'COVID': 0.92,
                'Lung Opacity': 0.86,
                'Viral Pneumonia': 0.81
            };

            

            const scatterData = {
                COVID: generateScatterData(1800, 0.85, 0.1, 0.75, 0.1, 0.05),
                NORMAL: generateScatterData(5000, 0.35, 0.15, 0.2, 0.1, 0.05),
                LUNG_OPACITY: generateScatterData(3000, 0.70, 0.1, 0.80, 0.1, 0.05),
                VIRAL_PNEUMONIA: generateScatterData(600, 0.55, 0.1, 0.55, 0.1, 0.05)
            };

            // Helpers para Chart.js
            function wrapLabels(label) {
                if (label.length <= 16) return label;
                const words = label.split(' ');
                let lines = [];
                let currentLine = words[0];
                for (let i = 1; i < words.length; i++) {
                    if (currentLine.length + words[i].length + 1 > 16) {
                        lines.push(currentLine);
                        currentLine = words[i];
                    } else {
                        currentLine += ' ' + words[i];
                    }
                }
                lines.push(currentLine);
                return lines;
            }

            function generateScatterData(count, xMean, xStdDev, yMean, yStdDev, zValue) {
                const data = [];
                for (let i = 0; i < count; i++) {
                    data.push({
                        x: parseFloat((xMean + (Math.random() - 0.5) * xStdDev).toFixed(2)),
                        y: parseFloat((yMean + (Math.random() - 0.5) * yStdDev).toFixed(2)),
                        r: 4 
                    });
                }
                return data;
            }
            
            const tooltipTitleCallback = function(tooltipItems) {
                const item = tooltipItems[0];
                let label = item.chart.data.labels[item.dataIndex];
                if (Array.isArray(label)) {
                    return label.join(' ');
                } else {
                    return label;
                }
            };
            
            // --- GRÁFICO 1: DISTRIBUCIÓN (DONUT) ---
            new Chart(document.getElementById('donutChart'), {
                type: 'doughnut',
                data: {
                    labels: Object.keys(classCounts).map(wrapLabels),
                    datasets: [{
                        data: Object.values(classCounts),
                        backgroundColor: ['#1E88E5', '#64B5F6', '#4CAF50', '#00BCD4'],
                        hoverOffset: 15
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '75%',
                    plugins: {
                        legend: { position: 'right' },
                        tooltip: { callbacks: { title: tooltipTitleCallback } },
                        datalabels: {
                            color: '#000',
                            formatter: (value, context) => {
                                const total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                const percentage = (value / total * 100).toFixed(1) + '%';
                                return percentage;
                            },
                            anchor: 'end',
                            align: 'end',
                            offset: 10
                        },
                        title: {
                            display: true,
                            text: `Total de Muestras: ${totalSamples.toLocaleString()}`,
                            padding: 10
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });

            // --- GRÁFICO 2: CONFIANZA DIAGNÓSTICA (BARRAS HORIZONTALES) ---
            const sortedConfidence = Object.entries(confidenceData).sort(([, a], [, b]) => b - a);
            const confidenceLabels = sortedConfidence.map(([key]) => key).map(wrapLabels);
            const confidenceValues = sortedConfidence.map(([, value]) => (value * 100));

            new Chart(document.getElementById('barChartConfianza'), {
                type: 'bar',
                data: {
                    labels: confidenceLabels,
                    datasets: [{
                        label: 'Probabilidad Promedio de Clase Dominante',
                        data: confidenceValues,
                        backgroundColor: ['#1E88E5', '#00BCD4', '#FFC107', '#4CAF50'],
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: { display: true, text: 'Probabilidad Promedio (%)' },
                            beginAtZero: true,
                            max: 100,
                            grid: { display: false }
                        },
                        y: {
                            grid: { display: false }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: { callbacks: { title: tooltipTitleCallback } },
                        datalabels: {
                            anchor: 'end',
                            align: 'right',
                            formatter: (value) => value.toFixed(1) + '%',
                            color: '#333'
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });

            // --- GRÁFICO 3: RELACIÓN CARACTERÍSTICAS (SCATTER PLOT) ---
            new Chart(document.getElementById('scatterChart'), {
                type: 'scatter',
                data: {
                    datasets: [
                        {
                            label: 'COVID (Alto GLCM/Opacidad)',
                            data: scatterData.COVID,
                            backgroundColor: '#1E88E5',
                        },
                        {
                            label: 'NORMAL (Bajo GLCM/Opacidad)',
                            data: scatterData.NORMAL,
                            backgroundColor: '#4CAF50',
                        },
                        {
                            label: 'LUNG OPACITY (Opacidad Extrema)',
                            data: scatterData.LUNG_OPACITY,
                            backgroundColor: '#FFC107',
                        },
                        {
                            label: 'VIRAL PNEUMONIA',
                            data: scatterData.VIRAL_PNEUMONIA,
                            backgroundColor: '#00BCD4',
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: { display: true, text: 'Valores de Textura (GLCM)' },
                            min: 0,
                            max: 1,
                        },
                        y: {
                            title: { display: true, text: 'Nivel de Opacidad' },
                            min: 0,
                            max: 1,
                        }
                    },
                    plugins: {
                        tooltip: { callbacks: { title: tooltipTitleCallback } },
                        legend: { position: 'bottom' }
                    }
                }
            });
        });
    </script>
</body>